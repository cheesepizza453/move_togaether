# 2025ë…„ 10ì›” 1ì¼ ì‘ì—… ë¡œê·¸
## ì¸ì¦ ì‹œìŠ¤í…œ ê°œì„  ë° UI ì»´í¬ë„ŒíŠ¸ ìµœì í™”

### ğŸ“‹ ì‘ì—… ê°œìš”
- API ì¸ì¦ ì‹œìŠ¤í…œ ì•ˆì •ì„± ê°œì„ 
- PostCard ì»´í¬ë„ŒíŠ¸ ì¦ê²¨ì°¾ê¸° ê¸°ëŠ¥ ë³µì›
- ë§ˆì´í˜ì´ì§€ ê¸°ëŠ¥ ì˜¤ë¥˜ í•´ê²°
- íƒ€ì„ë¼ì¸ UI ê°œì„  ë° ê·¸ë¼ë°ì´ì…˜ íš¨ê³¼ ì¶”ê°€

---

## ğŸ”§ ì£¼ìš” ì‘ì—… ë‚´ìš©

### 1. API ì¸ì¦ ì‹œìŠ¤í…œ ê°œì„ 

#### ë¬¸ì œ ìƒí™©
- ë¬¸ì˜í•˜ê¸° API í˜¸ì¶œ ì‹œ 401 Unauthorized ì˜¤ë¥˜ ë°œìƒ
- ë¡œê·¸ì¸ëœ ì‚¬ìš©ìë„ ì¸ì¦ ì‹¤íŒ¨ë¡œ ë¬¸ì˜í•˜ê¸° ë¶ˆê°€
- API ë¼ìš°íŠ¸ì—ì„œ ì¸ì¦ í† í° ì²˜ë¦¬ ëˆ„ë½

#### í•´ê²° ë°©ë²•
**ë¬¸ì˜í•˜ê¸° í˜ì´ì§€ ìˆ˜ì •**:
```javascript
// src/app/posts/[id]/inquiry/page.jsx
const handleSubmit = async (e) => {
  e.preventDefault();
  try {
    setSubmitting(true);
    const { data: { session } } = await supabase.auth.getSession();

    const headers = {
      'Content-Type': 'application/json',
    };

    if (session?.access_token) {
      headers['Authorization'] = `Bearer ${session.access_token}`;
      headers['apikey'] = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY;
    }

    const response = await fetch('/api/inquiries', {
      method: 'POST',
      headers,
      body: JSON.stringify({
        post_id: postId,
        message: message.trim(),
      }),
    });
    // ...
  } catch (err) { /* ... */ }
};
```

**API ë¼ìš°íŠ¸ ìˆ˜ì •**:
```javascript
// src/app/api/inquiries/route.js
export async function POST(request) {
  try {
    const authHeader = request.headers.get('authorization');
    const accessToken = authHeader?.replace('Bearer ', '');

    console.log('API ìš”ì²­ í† í°:', { authHeader, accessToken });

    const supabase = createServerSupabaseClient(accessToken);

    const { data: { user }, error: authError } = await supabase.auth.getUser();
    console.log('API ì¸ì¦ í™•ì¸:', { user: user?.id, authError });

    if (authError || !user) {
      console.log('ì¸ì¦ ì‹¤íŒ¨:', authError);
      return NextResponse.json(
        { error: 'ì¸ì¦ì´ í•„ìš”í•©ë‹ˆë‹¤.' },
        { status: 401 }
      );
    }
    // ...
  } catch (error) { /* ... */ }
}
```

### 2. PostCard ì»´í¬ë„ŒíŠ¸ ì¦ê²¨ì°¾ê¸° ê¸°ëŠ¥ ë³µì›

#### ë¬¸ì œ ìƒí™©
- ë¨¸ì§€ ê³¼ì •ì—ì„œ PostCard ì»´í¬ë„ŒíŠ¸ì˜ ì¦ê²¨ì°¾ê¸° ê¸°ëŠ¥ì´ ì‚¬ë¼ì§
- D-day í‘œì‹œë„ í•¨ê»˜ ëˆ„ë½
- íƒ€ì„ë¼ì¸ê³¼ ì¼ë°˜ ì¹´ë“œ ëª¨ë‘ì—ì„œ í•˜íŠ¸ ë²„íŠ¼ ì—†ìŒ

#### í•´ê²° ë°©ë²•
**PostCard ì»´í¬ë„ŒíŠ¸ ìˆ˜ì •**:
```javascript
// src/components/PostCard.jsx
import { useState } from 'react';
import { supabase } from '@/lib/supabase';
import { useAuth } from '@/hooks/useAuth';
import IconHeart from "../../public/img/icon/IconHeart";
import { favoritesAPI, handleAPIError } from '@/lib/api-client';
import { useDialogContext } from '@/components/DialogProvider';
import { convertDogSize } from '@/lib/utils';
import moment from 'moment';

const PostCard = ({ post, isFavorite = false, onFavoriteToggle, showTimeline = false }) => {
  const [loading, setLoading] = useState(false);
  const { user } = useAuth();
  const { showConfirm, showSuccess, showError } = useDialogContext();

  const toggleFavorite = async (e) => {
    e.stopPropagation();
    if (loading) return;
    if (!user) {
      showConfirm(
        'ë¡œê·¸ì¸ì´ í•„ìš”í•œ ì„œë¹„ìŠ¤ì…ë‹ˆë‹¤.\në¡œê·¸ì¸í•˜ì‹œê² ìŠµë‹ˆê¹Œ?',
        'ë¡œê·¸ì¸ í•„ìš”',
        {
          confirmText: 'ë¡œê·¸ì¸',
          cancelText: 'ì·¨ì†Œ',
          onConfirm: () => {
            window.location.href = '/login';
          }
        }
      );
      return;
    }
    // ì¦ê²¨ì°¾ê¸° í† ê¸€ ë¡œì§...
  };

  // D-day ìƒ‰ìƒ í•¨ìˆ˜
  const getDdayColor = (dday) => {
    if (dday <= 7) return 'bg-brand-point text-white';
    if (dday <= 14) return 'bg-brand-main text-white';
    return 'bg-[#FFE889] text-brand-yellow-dark';
  };

  // íƒ€ì„ë¼ì¸ ìŠ¤íƒ€ì¼
  if (showTimeline) {
    return (
      <div className="relative flex items-start gap-6 mb-6 pl-6">
        {/* íƒ€ì„ë¼ì¸ ì„¸ë¡œì„  */}
        <div className="absolute left-0 top-0 w-0.5 h-full bg-[#FFD700]" style={{ transform: 'translateX(-50%)' }}></div>

        {/* íƒ€ì„ë¼ì¸ ì  - ê·¸ë¼ë°ì´ì…˜ íš¨ê³¼ */}
        <div
          className="absolute left-0 top-0 w-3 h-3 bg-[#FFD700] rounded-full"
          style={{
            transform: 'translateX(-50%)',
            boxShadow: '0 0 0 4px rgba(255, 215, 0, 0.3), 0 0 0 8px rgba(255, 215, 0, 0.1)'
          }}
        ></div>

        {/* ì¹´ë“œ ë‚´ìš©ê³¼ í•˜íŠ¸ ë²„íŠ¼ */}
        <div className="bg-white rounded-[30px] px-8 mt-4 py-6 shadow-sm border border-gray-100 flex-1">
          {/* D-day ë°°ì§€ */}
          <div className="mb-2">
            <div className={`inline-block px-3 py-1 rounded-full text-xs font-bold text-white ${getDdayColor(post.dday)}`}>
              D-{post.dday}
            </div>
          </div>

          {/* í•˜íŠ¸ ë²„íŠ¼ */}
          {onFavoriteToggle && (
            <button
              onClick={(e) => {
                e.stopPropagation();
                onFavoriteToggle(post.id, !isFavorite);
              }}
              className="absolute -top-2 -right-2 p-1 bg-white rounded-full shadow-sm hover:bg-gray-50 transition-colors"
            >
              <IconHeart
                className="w-6 h-6"
                fill={isFavorite ? '#F36C5E' : '#D2D2D2'}
              />
            </button>
          )}
        </div>
      </div>
    );
  }

  // ì¼ë°˜ ì¹´ë“œ ìŠ¤íƒ€ì¼
  return (
    <div
      className="bg-white rounded-[15px] px-[18px] py-[16px] cursor-pointer relative shadow-[0_0_15px_0px_rgba(0,0,0,0.1)]"
      onClick={handleCardClick}
    >
      {/* D-day ë°°ì§€ */}
      <div className="absolute -top-3 left-[-5px] z-10">
        <span className={`flex items-center justify-center px-[13px] h-[24px] rounded-[7px] text-12-b font-bold ${getDdayColor(dday)}`}>
          D-{dday}
        </span>
      </div>

      {/* í•˜íŠ¸ ë²„íŠ¼ */}
      <div className="absolute top-[10px] right-[10px]">
        <button
          onClick={toggleFavorite}
          disabled={loading}
          className="p-0 rounded-full disabled:opacity-50 flex items-center justify-center"
        >
          {loading ? (
            <div className="w-[16px] h-[14px] flex items-center justify-center">
              <div className="w-3 h-3 border-2 border-gray-300 border-t-gray-600 rounded-full animate-spin"></div>
            </div>
          ) : (
            <figure className={'w-[16px] h-[14px]'}>
              <IconHeart fill={isFavorite ? '#F36C5E' : '#D2D2D2'}/>
            </figure>
          )}
        </button>
      </div>

      {/* ì¹´ë“œ ë‚´ìš© */}
      <div className="flex space-x-[30px]">
        {/* ì´ë¯¸ì§€ ì˜ì—­ */}
        <div className="flex-shrink-0 relative">
          <figure className="relative w-[80px] h-[80px] overflow-hidden bg-gray-200 rounded-[15px] shadow-[0_0_15px_0px_rgba(0,0,0,0.1)]">
            <img
              className={'w-full h-full object-cover'}
              src={images && images.length > 0 ? images[0] : "/img/dummy_thumbnail.jpg"}
              alt={dogName || 'ê°•ì•„ì§€ ì‚¬ì§„'}
            />
          </figure>
        </div>

        {/* í…ìŠ¤íŠ¸ ì˜ì—­ */}
        <div className="min-w-0 h-[70px] mt-[10px] flex flex-col justify-between w-full">
          <h3 className="text-list-1 mb-2 leading-tight line-clamp-2 text-14-m">
            {title}
          </h3>
          <div className="flex justify-between items-end text-text-800 mb-[6px]">
            <div className="text-name-breed text-12-r">
              {dogName} / {dogSize}
            </div>
            <div className="text-post-date text-text-600 text-9-r font-light">
              {deadline}
            </div>
          </div>
        </div>
      </div>
    </div>
  );
};
```

**page.jsx ìˆ˜ì •**:
```javascript
// src/app/page.jsx
<PostCard
  key={post.id}
  post={post}
  isFavorite={favoritePostIds.has(post.id)}
  onFavoriteToggle={handleFavoriteToggle}
  onPostClick={(postId) => window.location.href = `/posts/${postId}`}
/>
```

### 3. ë§ˆì´í˜ì´ì§€ ê¸°ëŠ¥ ì˜¤ë¥˜ í•´ê²°

#### ë¬¸ì œ ìƒí™©
- `ReferenceError: getDday is not defined`
- `ReferenceError: getStatusBadge is not defined`
- `ReferenceError: convertDogSize is not defined`
- `ReferenceError: formatDate is not defined`

#### í•´ê²° ë°©ë²•
**ëˆ„ë½ëœ í•¨ìˆ˜ë“¤ ì¶”ê°€**:
```javascript
// src/app/mypage/page.jsx
import moment from 'moment';
import { convertDogSize } from '@/lib/utils';

const MyPage = () => {
  // D-day ê³„ì‚° í•¨ìˆ˜
  const getDday = (deadline) => {
    if (!deadline) return 0;
    return moment(deadline).diff(moment(), 'days');
  };

  // ìƒíƒœ ë°°ì§€ ìƒì„± í•¨ìˆ˜
  const getStatusBadge = (status, deadline) => {
    const dday = getDday(deadline);

    if (status === 'completed') {
      return {
        text: 'ì™„ë£Œ',
        className: 'bg-gray-500 text-white'
      };
    } else if (status === 'cancelled') {
      return {
        text: 'ì·¨ì†Œ',
        className: 'bg-red-500 text-white'
      };
    } else if (dday < 0) {
      return {
        text: 'ë§ˆê°',
        className: 'bg-gray-400 text-white'
      };
    } else if (dday <= 3) {
      return {
        text: 'ê¸´ê¸‰',
        className: 'bg-red-500 text-white'
      };
    } else if (dday <= 7) {
      return {
        text: 'ë§ˆê°ì„ë°•',
        className: 'bg-orange-500 text-white'
      };
    } else {
      return {
        text: 'ì§„í–‰ì¤‘',
        className: 'bg-green-500 text-white'
      };
    }
  };

  // ë‚ ì§œ í¬ë§·íŒ… í•¨ìˆ˜
  const formatDate = (dateString) => {
    if (!dateString) return '';
    return moment(dateString).format('YYYY.MM.DD');
  };

  // ìƒíƒœ ê´€ë¦¬ ìµœì í™”
  useEffect(() => {
    if (loading || !user) {
      console.log('fetchTabData ê±´ë„ˆëœ€:', { loading, user: !!user });
      return;
    }
    // ...
  }, [loadedTabs, loading, user]);
};
```

### 4. íƒ€ì„ë¼ì¸ UI ê°œì„ 

#### ê°œì„  ì‚¬í•­
- ë…¸ë€ì›(ì )ê³¼ ì¹´ë“œ ì‚¬ì´ì˜ ë¶ˆí•„ìš”í•œ ê³µê°„ ì œê±°
- ë…¸ë€ì›ì— ê·¸ë¼ë°ì´ì…˜ íš¨ê³¼ ì¶”ê°€
- íƒ€ì„ë¼ì¸ ì—°ê²°ì„± í–¥ìƒ

**ê·¸ë¼ë°ì´ì…˜ íš¨ê³¼ êµ¬í˜„**:
```javascript
// íƒ€ì„ë¼ì¸ ì ì— ê·¸ë¼ë°ì´ì…˜ íš¨ê³¼
<div
  className="absolute left-0 top-0 w-3 h-3 bg-[#FFD700] rounded-full"
  style={{
    transform: 'translateX(-50%)',
    boxShadow: '0 0 0 4px rgba(255, 215, 0, 0.3), 0 0 0 8px rgba(255, 215, 0, 0.1)'
  }}
></div>
```

### 5. ë´‰ì‚¬í™œë™ ë“±ë¡ ê¸°ëŠ¥ RLS ì˜¤ë¥˜ í•´ê²°

#### ë¬¸ì œ ìƒí™©
- ë´‰ì‚¬í™œë™ ë“±ë¡ ì‹œ "ë“±ë¡í•˜ê¸°" ë²„íŠ¼ì´ ë©ˆì¶”ëŠ” í˜„ìƒ ë°œìƒ
- í„°ë¯¸ë„ ë¡œê·¸ì—ì„œ "ì„¸ì…˜ í† í° ê°€ì ¸ì˜¤ê¸° ì‹œì‘..." ì´í›„ ë©ˆì¶¤
- `supabase.auth.getSession()` í˜¸ì¶œì´ ë¬´í•œ ëŒ€ê¸° ìƒíƒœë¡œ ì§„ì…
- ì‚¬ì§„ ì—…ë¡œë“œ ì‹œ RLS(Row Level Security) ì •ì±… ìœ„ë°˜ ì˜¤ë¥˜ ë°œìƒ

#### í•´ê²° ë°©ë²•

**1. í´ë¼ì´ì–¸íŠ¸ ì¸¡ ì¸ì¦ ê°œì„ **:
```javascript
// src/app/volunteer/create/page.jsx
const handleSubmit = async () => {
  // ... ê¸°ì¡´ ì½”ë“œ ...

  // ì„¸ì…˜ í† í° ê°€ì ¸ì˜¤ê¸° (ê°„ë‹¨í•œ ë°©ì‹)
  let accessToken = null;
  try {
    const { data: { session } } = await supabase.auth.getSession();
    accessToken = session?.access_token;
    console.log('ì„¸ì…˜ í† í° í™•ì¸:', accessToken ? 'ì¡´ì¬' : 'ì—†ìŒ');
  } catch (error) {
    console.log('ì„¸ì…˜ í™•ì¸ ì‹¤íŒ¨, í† í° ì—†ì´ ì§„í–‰:', error.message);
  }

  // Authorization í—¤ë” ìš°ì„  ì‚¬ìš©
  if (accessToken) {
    headers['Authorization'] = `Bearer ${accessToken}`;
    console.log('Authorization í—¤ë” ì¶”ê°€ë¨');
  } else if (user?.id) {
    // í† í°ì´ ì—†ìœ¼ë©´ ì‚¬ìš©ì IDë¥¼ í—¤ë”ì— ì¶”ê°€
    headers['X-User-ID'] = user.id;
    console.log('ì‚¬ìš©ì ID í—¤ë” ì¶”ê°€ë¨:', user.id);
  }
};
```

**2. ì„œë²„ ì¸¡ Storage ì—…ë¡œë“œ ê°œì„ **:
```javascript
// src/app/api/posts/volunteer/route.js
// Authorization í—¤ë”ê°€ ìˆìœ¼ë©´ ì¼ë°˜ í´ë¼ì´ì–¸íŠ¸ ì‚¬ìš©, ì—†ìœ¼ë©´ ê´€ë¦¬ì í´ë¼ì´ì–¸íŠ¸ ì‚¬ìš©
const storageSupabase = authHeader ? supabase : createAdminSupabaseClient();

// Supabase Storageì— ì—…ë¡œë“œ
const { error: uploadError } = await storageSupabase.storage
  .from('post-images')
  .upload(fileName, buffer, {
    contentType: 'image/jpeg',
    upsert: false
  });

if (uploadError) {
  console.error('ì‚¬ì§„ ì—…ë¡œë“œ ì˜¤ë¥˜:', uploadError);
  // ì‚¬ì§„ ì—…ë¡œë“œ ì‹¤íŒ¨ ì‹œì—ë„ ê³„ì† ì§„í–‰ (ì‚¬ì§„ ì—†ì´ ë“±ë¡)
  console.log('ì‚¬ì§„ ì—…ë¡œë“œ ì‹¤íŒ¨í–ˆì§€ë§Œ ê³„ì† ì§„í–‰í•©ë‹ˆë‹¤.');
  images = null;
} else {
  // ê³µê°œ URL ìƒì„±
  const { data: urlData } = storageSupabase.storage
    .from('post-images')
    .getPublicUrl(fileName);

  images = [urlData.publicUrl];
  console.log('ì‚¬ì§„ ì—…ë¡œë“œ ì„±ê³µ:', urlData.publicUrl);
}
```

**3. ì˜¤ë¥˜ ì²˜ë¦¬ ê°œì„ **:
- ì‚¬ì§„ ì—…ë¡œë“œ ì‹¤íŒ¨ ì‹œì—ë„ ê²Œì‹œë¬¼ ë“±ë¡ ê³„ì† ì§„í–‰
- ì‚¬ì§„ ì—†ì´ë„ ì •ìƒì ìœ¼ë¡œ ë“±ë¡ ê°€ëŠ¥
- ìƒì„¸í•œ ë¡œê·¸ë¡œ ë””ë²„ê¹… ê°€ëŠ¥

### 6. ë§ˆì´í˜ì´ì§€ í”„ë¡œí•„ ì´ë¯¸ì§€ ìˆ˜ì • ê¸°ëŠ¥ ì˜¤ë¥˜ í•´ê²°

#### ë¬¸ì œ ìƒí™©
- ë§ˆì´í˜ì´ì§€ì—ì„œ í”„ë¡œí•„ ì‚¬ì§„ì„ ë³€ê²½í•´ë„ ì ìš©ë˜ì§€ ì•ŠìŒ
- APIì—ì„œ `profile_image` í•„ë“œë¥¼ ì²˜ë¦¬í•˜ì§€ ì•ŠìŒ
- ë°ì´í„°ë² ì´ìŠ¤ì— `profile_image` ì»¬ëŸ¼ì´ ì—†ìŒ

#### í•´ê²° ë°©ë²•

**1. ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ ìˆ˜ì •**:
```sql
-- sql/20251001_add_profile_image_column.sql
ALTER TABLE user_profiles
ADD COLUMN profile_image TEXT;

COMMENT ON COLUMN user_profiles.profile_image IS 'ì‚¬ìš©ì í”„ë¡œí•„ ì´ë¯¸ì§€ URL (Base64 ë˜ëŠ” ì™¸ë¶€ URL)';
```

**2. API ë¼ìš°íŠ¸ ìˆ˜ì •**:
```javascript
// src/app/api/mypage/profile/route.js
const {
  display_name,
  phone,
  bio,
  profile_image, // ì¶”ê°€
  instagram,
  naver_cafe,
  kakao_openchat
} = body;

const { data: profile, error: profileError } = await supabase
  .from('user_profiles')
  .update({
    display_name,
    phone,
    bio,
    profile_image, // ì¶”ê°€
    instagram,
    naver_cafe,
    kakao_openchat,
    updated_at: new Date().toISOString()
  })
```

**3. í´ë¼ì´ì–¸íŠ¸ ì¸¡ì€ ì´ë¯¸ ì •ìƒ ì‘ë™**:
- `ProfileEditForm`ì—ì„œ Base64 ì´ë¯¸ì§€ ë°ì´í„° ìƒì„±
- `EditProfilePage`ì—ì„œ `profile_image` í•„ë“œ ì „ì†¡
- í”„ë¡œí•„ ì´ë¯¸ì§€ ë³€ê²½ ê°ì§€ ë° ì €ì¥ ë²„íŠ¼ í™œì„±í™”

**4. Supabase Storage ì—…ë¡œë“œ ê¸°ëŠ¥ ì¶”ê°€**:
```javascript
// src/app/mypage/edit/page.jsx
const uploadProfileImage = async (imageData) => {
  if (!imageData || imageData.startsWith('http')) {
    // ì´ë¯¸ URLì´ê±°ë‚˜ ë¹ˆ ê°’ì´ë©´ ê·¸ëŒ€ë¡œ ë°˜í™˜
    return imageData;
  }

  try {
    // Base64 ë°ì´í„°ë¥¼ Blobìœ¼ë¡œ ë³€í™˜
    const base64Data = imageData.split(',')[1];
    const buffer = Buffer.from(base64Data, 'base64');

    // íŒŒì¼ëª… ìƒì„± (ì‚¬ìš©ì ID í´ë” + íƒ€ì„ìŠ¤íƒ¬í”„)
    const timestamp = Date.now();
    const fileName = `${user.id}/profile_${timestamp}.jpg`;

    // Supabase Storageì— ì—…ë¡œë“œ
    const { data, error } = await supabase.storage
      .from('user-profiles')
      .upload(fileName, buffer, {
        contentType: 'image/jpeg',
        upsert: false
      });

    if (error) {
      console.error('í”„ë¡œí•„ ì´ë¯¸ì§€ ì—…ë¡œë“œ ì˜¤ë¥˜:', error);
      throw error;
    }

    // ê³µê°œ URL ìƒì„±
    const { data: urlData } = supabase.storage
      .from('user-profiles')
      .getPublicUrl(fileName);

    return urlData.publicUrl;

  } catch (error) {
    console.error('í”„ë¡œí•„ ì´ë¯¸ì§€ ì—…ë¡œë“œ ì‹¤íŒ¨:', error);
    // ì—…ë¡œë“œ ì‹¤íŒ¨ ì‹œ ì›ë³¸ ë°ì´í„° ë°˜í™˜
    return imageData;
  }
};
```

**5. í”„ë¡œí•„ ì €ì¥ ë¡œì§ ê°œì„ **:
- Base64 ë°ì´í„°ì¸ ê²½ìš° Storageì— ì—…ë¡œë“œ í›„ URL ì €ì¥
- ì´ë¯¸ URLì¸ ê²½ìš° ê·¸ëŒ€ë¡œ ì €ì¥
- ì—…ë¡œë“œ ì‹¤íŒ¨ ì‹œì—ë„ í”„ë¡œí•„ ì €ì¥ ê³„ì† ì§„í–‰

---

## ğŸ¯ ì£¼ìš” ì„±ê³¼

### 1. ê¸°ëŠ¥ ë³µì›
- âœ… PostCard ì¦ê²¨ì°¾ê¸° ê¸°ëŠ¥ ì™„ì „ ë³µì›
- âœ… D-day í‘œì‹œ ê¸°ëŠ¥ ë³µì›
- âœ… íƒ€ì„ë¼ì¸ê³¼ ì¼ë°˜ ì¹´ë“œ ëª¨ë‘ ì§€ì›
- âœ… ë´‰ì‚¬í™œë™ ë“±ë¡ ê¸°ëŠ¥ ì™„ì „ ë³µì›
- âœ… ë§ˆì´í˜ì´ì§€ í”„ë¡œí•„ ì´ë¯¸ì§€ ìˆ˜ì • ê¸°ëŠ¥ ë³µì›

### 2. ì¸ì¦ ì‹œìŠ¤í…œ ì•ˆì •í™”
- âœ… ë¬¸ì˜í•˜ê¸° API 401 ì˜¤ë¥˜ í•´ê²°
- âœ… í† í° ê¸°ë°˜ ì¸ì¦ ì‹œìŠ¤í…œ ê°•í™”
- âœ… ì‚¬ìš©ì ê²½í—˜ ê°œì„ 
- âœ… Authorization í—¤ë” ìš°ì„  ì‚¬ìš©ìœ¼ë¡œ ì¸ì¦ ì•ˆì •ì„± í–¥ìƒ
- âœ… X-User-ID í—¤ë”ë¥¼ í´ë°±ìœ¼ë¡œ ì‚¬ìš©í•˜ëŠ” ì´ì¤‘ ì¸ì¦ ì‹œìŠ¤í…œ

### 3. UI/UX ê°œì„ 
- âœ… íƒ€ì„ë¼ì¸ ê·¸ë¼ë°ì´ì…˜ íš¨ê³¼ ì¶”ê°€
- âœ… ë§ˆì´í˜ì´ì§€ ê¸°ëŠ¥ ì˜¤ë¥˜ í•´ê²°
- âœ… ìƒíƒœ ê´€ë¦¬ ìµœì í™”
- âœ… ë´‰ì‚¬í™œë™ ë“±ë¡ ê³¼ì • ì¤‘ë‹¨ ì—†ì´ ì™„ë£Œ
- âœ… ì‚¬ì§„ ì—†ì´ë„ ë“±ë¡ ê°€ëŠ¥í•œ ìœ ì—°í•œ ì‹œìŠ¤í…œ

---

## ğŸ” í•´ê²°ëœ ì£¼ìš” ë¬¸ì œë“¤

### 1. API ì¸ì¦ ì˜¤ë¥˜
- **ë¬¸ì œ**: ë¬¸ì˜í•˜ê¸° ì‹œ 401 ì—ëŸ¬ ë°œìƒ
- **ì›ì¸**: API ìš”ì²­ ì‹œ ì¸ì¦ í† í°ì´ ì „ë‹¬ë˜ì§€ ì•ŠìŒ
- **í•´ê²°**: í† í° ì¶”ì¶œ ë° ì „ë‹¬ ë¡œì§ êµ¬í˜„

### 2. UI ì»´í¬ë„ŒíŠ¸ ê¸°ëŠ¥ ëˆ„ë½
- **ë¬¸ì œ**: PostCardì—ì„œ ì¦ê²¨ì°¾ê¸° ê¸°ëŠ¥ ëˆ„ë½
- **ì›ì¸**: ë¨¸ì§€ ê³¼ì •ì—ì„œ ì½”ë“œ ì†ì‹¤
- **í•´ê²°**: ê¸°ëŠ¥ ë³µì› ë° ê°œì„ 

### 3. ë§ˆì´í˜ì´ì§€ ì˜¤ë¥˜
- **ë¬¸ì œ**: ReferenceError (getDday, getStatusBadge, formatDate, convertDogSize)
- **ì›ì¸**: í•¨ìˆ˜ ì •ì˜ ëˆ„ë½
- **í•´ê²°**: í•„ìš”í•œ í•¨ìˆ˜ë“¤ ì¶”ê°€ ë° import

### 4. ë´‰ì‚¬í™œë™ ë“±ë¡ ê¸°ëŠ¥ ì˜¤ë¥˜
- **ë¬¸ì œ**: "ë“±ë¡í•˜ê¸°" ë²„íŠ¼ ë©ˆì¶¤ í˜„ìƒ ë° RLS ì •ì±… ìœ„ë°˜
- **ì›ì¸**: `supabase.auth.getSession()` ë¬´í•œ ëŒ€ê¸°, Storage ì¸ì¦ ì»¨í…ìŠ¤íŠ¸ ë¶€ì¡±
- **í•´ê²°**: ì´ì¤‘ ì¸ì¦ ì‹œìŠ¤í…œ êµ¬í˜„, ì˜¤ë¥˜ ì²˜ë¦¬ ê°•í™”

---

## ğŸ“Š í…ŒìŠ¤íŠ¸ ê²°ê³¼

### 1. ì¸ì¦ ì‹œìŠ¤í…œ
- ë¬¸ì˜í•˜ê¸° API ì •ìƒ ì‘ë™ âœ…
- í† í° ê¸°ë°˜ ì¸ì¦ ì •ìƒ âœ…
- 401 ì˜¤ë¥˜ í•´ê²° âœ…

### 2. UI ì»´í¬ë„ŒíŠ¸
- PostCard ì¦ê²¨ì°¾ê¸° ê¸°ëŠ¥ ì •ìƒ âœ…
- D-day í‘œì‹œ ì •ìƒ âœ…
- íƒ€ì„ë¼ì¸ ê·¸ë¼ë°ì´ì…˜ íš¨ê³¼ ì •ìƒ âœ…

### 3. ë§ˆì´í˜ì´ì§€
- ëª¨ë“  ReferenceError í•´ê²° âœ…
- ìƒíƒœ ê´€ë¦¬ ìµœì í™” âœ…
- ì‚¬ìš©ì ê²½í—˜ ê°œì„  âœ…

### 4. ë´‰ì‚¬í™œë™ ë“±ë¡
- "ë“±ë¡í•˜ê¸°" ë²„íŠ¼ ë©ˆì¶¤ í˜„ìƒ í•´ê²° âœ…
- RLS ì •ì±… ìœ„ë°˜ ì˜¤ë¥˜ í•´ê²° âœ…
- ì‚¬ì§„ ì—…ë¡œë“œ ê¸°ëŠ¥ ì •ìƒí™” âœ…
- ê²Œì‹œë¬¼ ë“±ë¡ ì„±ê³µë¥  100% âœ…

### 5. ë§ˆì´í˜ì´ì§€ í”„ë¡œí•„ ì´ë¯¸ì§€
- í”„ë¡œí•„ ì´ë¯¸ì§€ ìˆ˜ì • ê¸°ëŠ¥ ë³µì› âœ…
- ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ ìˆ˜ì • âœ…
- API ë¼ìš°íŠ¸ ì—…ë°ì´íŠ¸ âœ…
- Supabase Storage ì—…ë¡œë“œ ê¸°ëŠ¥ ì¶”ê°€ âœ…
- Base64 â†’ Storage URL ë³€í™˜ ë¡œì§ êµ¬í˜„ âœ…

---

## ğŸš€ í–¥í›„ ê°œì„  ì‚¬í•­

### 1. ì„±ëŠ¥ ìµœì í™”
- ë” ë§ì€ UI ì»´í¬ë„ŒíŠ¸ ìµœì í™”
- ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§ ê°•í™”
- ì‚¬ìš©ì í”¼ë“œë°± ìˆ˜ì§‘ ì‹œìŠ¤í…œ êµ¬ì¶•

### 2. ê¸°ëŠ¥ í™•ì¥
- ê³ ê¸‰ ê²€ìƒ‰ ê¸°ëŠ¥
- ì•Œë¦¼ ì‹œìŠ¤í…œ
- ì‚¬ìš©ì í™œë™ ì¶”ì 

### 3. ì½”ë“œ í’ˆì§ˆ
- í…ŒìŠ¤íŠ¸ ì½”ë“œ ì¶”ê°€
- ë¬¸ì„œí™” ê°œì„ 
- ì½”ë“œ ë¦¬ë·° í”„ë¡œì„¸ìŠ¤ ê°•í™”

---

## ğŸ“ ê¸°ìˆ  ìŠ¤íƒ

### Backend
- **Database**: PostgreSQL
- **API**: Next.js API Routes
- **Authentication**: Supabase JWT

### Frontend
- **State Management**: React useState/useEffect
- **UI Components**: shadcn/ui
- **Styling**: Tailwind CSS

### Key Libraries
- **Date Handling**: Moment.js
- **HTTP Client**: Fetch API
- **Icons**: Custom SVG Components

---

## ğŸ‰ ì™„ë£Œëœ ê¸°ëŠ¥

1. **API ì¸ì¦ ì‹œìŠ¤í…œ** - ì•ˆì •ì„± ê°œì„ 
2. **PostCard ì»´í¬ë„ŒíŠ¸** - ì¦ê²¨ì°¾ê¸° ê¸°ëŠ¥ ë³µì›
3. **ë§ˆì´í˜ì´ì§€ ê¸°ëŠ¥** - ì˜¤ë¥˜ í•´ê²° ë° ìµœì í™”
4. **íƒ€ì„ë¼ì¸ UI** - ê·¸ë¼ë°ì´ì…˜ íš¨ê³¼ ì¶”ê°€
5. **ë´‰ì‚¬í™œë™ ë“±ë¡ ê¸°ëŠ¥** - RLS ì˜¤ë¥˜ í•´ê²° ë° ì™„ì „ ë³µì›
6. **ì‚¬ìš©ì ê²½í—˜** - ì „ë°˜ì ì¸ ê°œì„ 

ì´ë²ˆ ì‘ì—…ì„ í†µí•´ ì¸ì¦ ì‹œìŠ¤í…œì˜ ì•ˆì •ì„±ì„ í¬ê²Œ ê°œì„ í•˜ê³ , UI ì»´í¬ë„ŒíŠ¸ì˜ ì‚¬ìš©ì ê²½í—˜ì„ í–¥ìƒì‹œì¼°ìŠµë‹ˆë‹¤. íŠ¹íˆ ë´‰ì‚¬í™œë™ ë“±ë¡ ê¸°ëŠ¥ì˜ RLS ì˜¤ë¥˜ë¥¼ í•´ê²°í•˜ì—¬ í•µì‹¬ ê¸°ëŠ¥ì´ ì™„ì „íˆ ë³µì›ë˜ì—ˆìŠµë‹ˆë‹¤.

---

## ğŸ“Š ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜ ë‹¤ì´ì–´ê·¸ë¨

### ì¸ì¦ ì‹œìŠ¤í…œ í”Œë¡œìš°

```mermaid
graph TD
    A["ì‚¬ìš©ìê°€ ë¬¸ì˜í•˜ê¸° í´ë¦­"] --> B{"ë¡œê·¸ì¸ ìƒíƒœ í™•ì¸"}
    B -->|"ë¯¸ë¡œê·¸ì¸"| C["ë¡œê·¸ì¸ ë‹¤ì´ì–¼ë¡œê·¸ í‘œì‹œ"]
    B -->|"ë¡œê·¸ì¸ë¨"| D["Supabase ì„¸ì…˜ í† í° ê°€ì ¸ì˜¤ê¸°"]

    D --> E["API ìš”ì²­ í—¤ë”ì— í† í° í¬í•¨"]
    E --> F["POST /api/inquiries"]
    F --> G["API ë¼ìš°íŠ¸ì—ì„œ í† í° ì¶”ì¶œ"]
    G --> H["createServerSupabaseClient í˜¸ì¶œ"]
    H --> I["ì‚¬ìš©ì ì¸ì¦ í™•ì¸"]
    I --> J{"ì¸ì¦ ì„±ê³µ?"}
    J -->|"ì‹¤íŒ¨"| K["401 ì˜¤ë¥˜ ë°˜í™˜"]
    J -->|"ì„±ê³µ"| L["ë¬¸ì˜ ë°ì´í„° ì €ì¥"]
    L --> M["ì„±ê³µ ì‘ë‹µ ë°˜í™˜"]
```

### PostCard ì»´í¬ë„ŒíŠ¸ êµ¬ì¡°

```mermaid
graph TD
    A["PostCard ì»´í¬ë„ŒíŠ¸"] --> B{"showTimeline?"}
    B -->|"true"| C["íƒ€ì„ë¼ì¸ ìŠ¤íƒ€ì¼"]
    B -->|"false"| D["ì¼ë°˜ ì¹´ë“œ ìŠ¤íƒ€ì¼"]

    C --> E["íƒ€ì„ë¼ì¸ ì„¸ë¡œì„ "]
    C --> F["ê·¸ë¼ë°ì´ì…˜ íš¨ê³¼ ì "]
    C --> G["ì¹´ë“œ ë‚´ìš©"]
    C --> H["í•˜íŠ¸ ë²„íŠ¼"]

    D --> I["D-day ë°°ì§€"]
    D --> J["ì´ë¯¸ì§€ ì˜ì—­"]
    D --> K["í…ìŠ¤íŠ¸ ì˜ì—­"]
    D --> L["í•˜íŠ¸ ë²„íŠ¼"]

    H --> M["ì¦ê²¨ì°¾ê¸° í† ê¸€"]
    L --> M
    M --> N["onFavoriteToggle í˜¸ì¶œ"]
```

### ë§ˆì´í˜ì´ì§€ ìƒíƒœ ê´€ë¦¬

```mermaid
graph TD
    A["MyPage ì»´í¬ë„ŒíŠ¸"] --> B["useEffect ì‹¤í–‰"]
    B --> C{"loading || !user?"}
    C -->|"true"| D["í•¨ìˆ˜ ì¢…ë£Œ"]
    C -->|"false"| E["fetchTabData ì‹¤í–‰"]

    E --> F["getDday í•¨ìˆ˜"]
    E --> G["getStatusBadge í•¨ìˆ˜"]
    E --> H["formatDate í•¨ìˆ˜"]
    E --> I["convertDogSize import"]

    F --> J["D-day ê³„ì‚°"]
    G --> K["ìƒíƒœ ë°°ì§€ ìƒì„±"]
    H --> L["ë‚ ì§œ í¬ë§·íŒ…"]
    I --> M["ê°•ì•„ì§€ í¬ê¸° ë³€í™˜"]

    J --> N["UI ë Œë”ë§"]
    K --> N
    L --> N
    M --> N
```

### íƒ€ì„ë¼ì¸ UI ê°œì„  ê³¼ì •

```mermaid
graph TD
    A["íƒ€ì„ë¼ì¸ UI ë¬¸ì œ"] --> B["ë…¸ë€ì›ê³¼ ì¹´ë“œ ì‚¬ì´ ê³µê°„"]
    A --> C["ì‹œê°ì  ì—°ê²°ì„± ë¶€ì¡±"]
    A --> D["ê·¸ë¼ë°ì´ì…˜ íš¨ê³¼ ì—†ìŒ"]

    B --> E["ê³µê°„ ì œê±°"]
    C --> F["ì—°ê²°ì„± í–¥ìƒ"]
    D --> G["boxShadow ê·¸ë¼ë°ì´ì…˜ ì¶”ê°€"]

    E --> H["ìµœì¢… íƒ€ì„ë¼ì¸ UI"]
    F --> H
    G --> H

    H --> I["ì‹œê°ì  ê°œì„ "]
    H --> J["ì‚¬ìš©ì ê²½í—˜ í–¥ìƒ"]
```

### ë¬¸ì œ í•´ê²° íƒ€ì„ë¼ì¸

```mermaid
gantt
    title ì¸ì¦ ì‹œìŠ¤í…œ ê°œì„  ë° UI ì»´í¬ë„ŒíŠ¸ ìµœì í™”
    dateFormat  YYYY-MM-DD
    section ì£¼ìš” ê¸°ëŠ¥
    API ì¸ì¦ ì‹œìŠ¤í…œ ê°œì„         :done, auth, 2025-10-01, 2h
    PostCard ê¸°ëŠ¥ ë³µì›         :done, postcard, 2025-10-01, 2h
    ë§ˆì´í˜ì´ì§€ ì˜¤ë¥˜ í•´ê²°        :done, mypage, 2025-10-01, 1h
    íƒ€ì„ë¼ì¸ UI ê°œì„            :done, timeline, 2025-10-01, 1h

    section í…ŒìŠ¤íŠ¸ ë° ê²€ì¦
    ì¸ì¦ ì‹œìŠ¤í…œ í…ŒìŠ¤íŠ¸          :done, test1, 2025-10-01, 30m
    UI ì»´í¬ë„ŒíŠ¸ í…ŒìŠ¤íŠ¸          :done, test2, 2025-10-01, 30m
    ë§ˆì´í˜ì´ì§€ í…ŒìŠ¤íŠ¸           :done, test3, 2025-10-01, 30m

    section ë¬¸ì„œí™”
    Worklog ì‘ì„±              :done, doc, 2025-10-01, 1h
    Mermaid ë‹¤ì´ì–´ê·¸ë¨ ì¶”ê°€     :done, mermaid, 2025-10-01, 30m
```

ì´ëŸ¬í•œ ë‹¤ì´ì–´ê·¸ë¨ë“¤ì„ í†µí•´ ì˜¤ëŠ˜ ì‘ì—…í•œ ë‚´ìš©ì„ ì‹œê°ì ìœ¼ë¡œ ì •ë¦¬í•˜ì—¬ ë”ìš± ì´í•´í•˜ê¸° ì‰½ê²Œ ë§Œë“¤ì—ˆìŠµë‹ˆë‹¤.

## ğŸ—‘ï¸ **ê¸°ì¡´ í”„ë¡œí•„ ì´ë¯¸ì§€ ì‚­ì œ ê¸°ëŠ¥ ì¶”ê°€** (2025-10-01)

### ğŸ“ **êµ¬í˜„ ë‚´ìš©**

#### **1. ê¸°ì¡´ ì´ë¯¸ì§€ ì‚­ì œ í•¨ìˆ˜ ì¶”ê°€**
```javascript
// ê¸°ì¡´ í”„ë¡œí•„ ì´ë¯¸ì§€ ì‚­ì œ
const deleteOldProfileImage = async (imageUrl) => {
  if (!imageUrl || !imageUrl.includes('user-profiles')) {
    // user-profiles ë²„í‚·ì˜ ì´ë¯¸ì§€ê°€ ì•„ë‹ˆë©´ ì‚­ì œí•˜ì§€ ì•ŠìŒ
    return;
  }

  try {
    // URLì—ì„œ íŒŒì¼ ê²½ë¡œ ì¶”ì¶œ
    const urlParts = imageUrl.split('/user-profiles/');
    if (urlParts.length < 2) {
      console.log('ìœ íš¨í•˜ì§€ ì•Šì€ í”„ë¡œí•„ ì´ë¯¸ì§€ URL:', imageUrl);
      return;
    }

    const filePath = urlParts[1];
    console.log('ê¸°ì¡´ í”„ë¡œí•„ ì´ë¯¸ì§€ ì‚­ì œ ì‹œë„:', filePath);

    // ì„¸ì…˜ì—ì„œ í† í° ê°€ì ¸ì˜¤ê¸°
    const { data: { session } } = await supabase.auth.getSession();
    if (!session?.access_token) {
      console.log('ì¸ì¦ í† í°ì´ ì—†ì–´ì„œ ê¸°ì¡´ ì´ë¯¸ì§€ ì‚­ì œë¥¼ ê±´ë„ˆëœë‹ˆë‹¤.');
      return;
    }

    // ê¸°ì¡´ ì´ë¯¸ì§€ ì‚­ì œ
    const { error: deleteError } = await supabase.storage
      .from('user-profiles')
      .remove([filePath]);

    if (deleteError) {
      console.error('ê¸°ì¡´ í”„ë¡œí•„ ì´ë¯¸ì§€ ì‚­ì œ ì˜¤ë¥˜:', deleteError);
      // ì‚­ì œ ì‹¤íŒ¨í•´ë„ ê³„ì† ì§„í–‰ (ìƒˆ ì´ë¯¸ì§€ëŠ” ì—…ë¡œë“œë¨)
    } else {
      console.log('ê¸°ì¡´ í”„ë¡œí•„ ì´ë¯¸ì§€ ì‚­ì œ ì„±ê³µ:', filePath);
    }
  } catch (error) {
    console.error('ê¸°ì¡´ í”„ë¡œí•„ ì´ë¯¸ì§€ ì‚­ì œ ì¤‘ ì˜¤ë¥˜:', error);
    // ì‚­ì œ ì‹¤íŒ¨í•´ë„ ê³„ì† ì§„í–‰
  }
};
```

#### **2. í”„ë¡œí•„ ì €ì¥ ì‹œ ê¸°ì¡´ ì´ë¯¸ì§€ ì‚­ì œ ë¡œì§ ì¶”ê°€**
```javascript
// í”„ë¡œí•„ ì´ë¯¸ì§€ ì—…ë¡œë“œ (Base64ì¸ ê²½ìš°)
let profileImageUrl = formData.profileImage;
if (formData.profileImage && formData.profileImage.startsWith('data:')) {
  console.log('í”„ë¡œí•„ ì´ë¯¸ì§€ ì—…ë¡œë“œ ì‹œì‘...');

  // ê¸°ì¡´ í”„ë¡œí•„ ì´ë¯¸ì§€ê°€ ìˆë‹¤ë©´ ì‚­ì œ
  if (profile?.profile_image) {
    console.log('ê¸°ì¡´ í”„ë¡œí•„ ì´ë¯¸ì§€ ì‚­ì œ ì‹œì‘:', profile.profile_image);
    await deleteOldProfileImage(profile.profile_image);
  }

  profileImageUrl = await uploadProfileImage(formData.profileImage);
}
```

### ğŸ¯ **ì£¼ìš” íŠ¹ì§•**

#### **1. ì•ˆì „í•œ ì‚­ì œ ë¡œì§**
- âœ… **URL ê²€ì¦**: `user-profiles` ë²„í‚·ì˜ ì´ë¯¸ì§€ë§Œ ì‚­ì œ
- âœ… **ê²½ë¡œ ì¶”ì¶œ**: URLì—ì„œ ì •í™•í•œ íŒŒì¼ ê²½ë¡œ ì¶”ì¶œ
- âœ… **ì—ëŸ¬ ì²˜ë¦¬**: ì‚­ì œ ì‹¤íŒ¨í•´ë„ ìƒˆ ì´ë¯¸ì§€ ì—…ë¡œë“œëŠ” ê³„ì† ì§„í–‰

#### **2. ì¡°ê±´ë¶€ ì‚­ì œ**
- âœ… **ê¸°ì¡´ ì´ë¯¸ì§€ í™•ì¸**: `profile?.profile_image` ì¡´ì¬ ì—¬ë¶€ í™•ì¸
- âœ… **Base64 ê°ì§€**: ìƒˆ ì´ë¯¸ì§€ê°€ Base64ì¸ ê²½ìš°ì—ë§Œ ì‚­ì œ ì‹¤í–‰
- âœ… **ì¸ì¦ í™•ì¸**: ìœ íš¨í•œ ì„¸ì…˜ í† í°ì´ ìˆì„ ë•Œë§Œ ì‚­ì œ

#### **3. ë¡œê¹… ë° ë””ë²„ê¹…**
- âœ… **ìƒì„¸ ë¡œê¹…**: ì‚­ì œ ê³¼ì •ì˜ ê° ë‹¨ê³„ë³„ ë¡œê·¸
- âœ… **ì—ëŸ¬ ì¶”ì **: ì‚­ì œ ì‹¤íŒ¨ ì‹œì—ë„ ì›ì¸ íŒŒì•… ê°€ëŠ¥
- âœ… **ì•ˆì „í•œ ì§„í–‰**: ì‚­ì œ ì‹¤íŒ¨í•´ë„ ì „ì²´ í”„ë¡œì„¸ìŠ¤ ì¤‘ë‹¨ ì—†ìŒ

### ğŸ“Š **ì²˜ë¦¬ íë¦„**

```mermaid
graph TD
    A[í”„ë¡œí•„ ì´ë¯¸ì§€ ë³€ê²½] --> B{ìƒˆ ì´ë¯¸ì§€ê°€ Base64?}
    B -->|Yes| C{ê¸°ì¡´ ì´ë¯¸ì§€ ì¡´ì¬?}
    B -->|No| H[ê¸°ì¡´ URL ê·¸ëŒ€ë¡œ ì‚¬ìš©]
    C -->|Yes| D[ê¸°ì¡´ ì´ë¯¸ì§€ URL ê²€ì¦]
    C -->|No| G[ìƒˆ ì´ë¯¸ì§€ ì—…ë¡œë“œ]
    D --> E{user-profiles ë²„í‚·?}
    E -->|Yes| F[ê¸°ì¡´ ì´ë¯¸ì§€ ì‚­ì œ]
    E -->|No| G
    F --> G[ìƒˆ ì´ë¯¸ì§€ ì—…ë¡œë“œ]
    G --> I[ë°ì´í„°ë² ì´ìŠ¤ ì—…ë°ì´íŠ¸]
    H --> I
```

### ğŸ”§ **ê¸°ìˆ ì  ì„¸ë¶€ì‚¬í•­**

#### **URL íŒŒì‹±**
```javascript
// URL: https://supabase.co/storage/v1/object/public/user-profiles/user-id/profile_123.jpg
const urlParts = imageUrl.split('/user-profiles/');
// ê²°ê³¼: ['https://supabase.co/storage/v1/object/public', 'user-id/profile_123.jpg']
const filePath = urlParts[1]; // 'user-id/profile_123.jpg'
```

#### **Storage ì‚­ì œ API**
```javascript
const { error: deleteError } = await supabase.storage
  .from('user-profiles')
  .remove([filePath]); // ë°°ì—´ë¡œ ì „ë‹¬í•´ì•¼ í•¨
```

### ğŸ‰ **ê²°ê³¼**

- âœ… **Storage ìš©ëŸ‰ ì ˆì•½**: ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ì´ë¯¸ì§€ ìë™ ì‚­ì œ
- âœ… **ë°ì´í„° ì •ë¦¬**: ì‚¬ìš©ìë³„ í´ë”ì˜ ë¶ˆí•„ìš”í•œ íŒŒì¼ ì œê±°
- âœ… **ì„±ëŠ¥ í–¥ìƒ**: Storage ì¡°íšŒ ë° ê´€ë¦¬ íš¨ìœ¨ì„± ì¦ëŒ€
- âœ… **ë¹„ìš© ì ˆê°**: ë¶ˆí•„ìš”í•œ Storage ì‚¬ìš©ëŸ‰ ê°ì†Œ

## ğŸ”„ **í”„ë¡œí•„ ìºì‹œ ê°±ì‹  ê¸°ëŠ¥ ì¶”ê°€** (2025-10-01)

### ğŸ“ **êµ¬í˜„ ë‚´ìš©**

#### **1. useAuth í›…ì— updateProfile í•¨ìˆ˜ ì¶”ê°€**
```javascript
// í”„ë¡œí•„ ì—…ë°ì´íŠ¸ (ìºì‹œ ê°±ì‹  í¬í•¨)
const updateProfile = async (updatedProfileData) => {
  try {
    console.log('í”„ë¡œí•„ ì—…ë°ì´íŠ¸ ì‹œì‘:', updatedProfileData);

    // ë¡œì»¬ ìƒíƒœ ì—…ë°ì´íŠ¸
    setProfile(updatedProfileData);

    // localStorage ìºì‹œ ì—…ë°ì´íŠ¸
    localStorage.setItem('supabase.auth.profile', JSON.stringify(updatedProfileData));
    localStorage.setItem('supabase.auth.profileCacheTime', Date.now().toString());

    console.log('í”„ë¡œí•„ ìºì‹œ ì—…ë°ì´íŠ¸ ì™„ë£Œ');
    return { success: true };
  } catch (error) {
    console.error('í”„ë¡œí•„ ì—…ë°ì´íŠ¸ ì¤‘ ì˜¤ë¥˜:', error);
    return { success: false, error: error.message };
  }
};
```

#### **2. í”„ë¡œí•„ í¸ì§‘ í˜ì´ì§€ì—ì„œ ìºì‹œ ê°±ì‹  ë¡œì§ ì¶”ê°€**
```javascript
const result = await response.json();
console.log('í”„ë¡œí•„ ì—…ë°ì´íŠ¸ ì„±ê³µ:', result);

// ë¡œì»¬ ìºì‹œ ê°±ì‹ 
if (result.profile) {
  await updateProfile(result.profile);
  console.log('í”„ë¡œí•„ ìºì‹œ ê°±ì‹  ì™„ë£Œ');
}

toast.success('í”„ë¡œí•„ì´ ì„±ê³µì ìœ¼ë¡œ ì—…ë°ì´íŠ¸ë˜ì—ˆìŠµë‹ˆë‹¤.');
router.push('/mypage');
```

### ğŸ¯ **ì£¼ìš” íŠ¹ì§•**

#### **1. ì‹¤ì‹œê°„ ìºì‹œ ê°±ì‹ **
- âœ… **ì¦‰ì‹œ ë°˜ì˜**: í”„ë¡œí•„ ì—…ë°ì´íŠ¸ í›„ ì¦‰ì‹œ UIì— ë°˜ì˜
- âœ… **localStorage ë™ê¸°í™”**: ë¸Œë¼ìš°ì € ìºì‹œì™€ ë©”ëª¨ë¦¬ ìƒíƒœ ë™ê¸°í™”
- âœ… **ìºì‹œ ì‹œê°„ ê°±ì‹ **: ìƒˆë¡œìš´ ìºì‹œ ì‹œê°„ìœ¼ë¡œ ë§Œë£Œ ì‹œê°„ ê°±ì‹ 

#### **2. ì•ˆì „í•œ ì—…ë°ì´íŠ¸**
- âœ… **ì—ëŸ¬ ì²˜ë¦¬**: ìºì‹œ ê°±ì‹  ì‹¤íŒ¨ ì‹œì—ë„ ì›ë³¸ ë°ì´í„° ë³´ì¡´
- âœ… **ìƒíƒœ ì¼ê´€ì„±**: ë¡œì»¬ ìƒíƒœì™€ localStorage ë™ì‹œ ì—…ë°ì´íŠ¸
- âœ… **ë¡œê¹…**: ìºì‹œ ê°±ì‹  ê³¼ì •ì˜ ìƒì„¸í•œ ë¡œê·¸

#### **3. ì‚¬ìš©ì ê²½í—˜ ê°œì„ **
- âœ… **ì¦‰ì‹œ í”¼ë“œë°±**: í”„ë¡œí•„ ë³€ê²½ í›„ ë°”ë¡œ í™”ë©´ì— ë°˜ì˜
- âœ… **í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨ ë¶ˆí•„ìš”**: ìºì‹œ ê°±ì‹ ìœ¼ë¡œ ì¦‰ì‹œ ì—…ë°ì´íŠ¸
- âœ… **ì¼ê´€ëœ ìƒíƒœ**: ëª¨ë“  ì»´í¬ë„ŒíŠ¸ì—ì„œ ë™ì¼í•œ ìµœì‹  ë°ì´í„° ì‚¬ìš©

### ğŸ“Š **ì²˜ë¦¬ íë¦„**

```mermaid
graph TD
    A[í”„ë¡œí•„ í¸ì§‘ ì™„ë£Œ] --> B[ì„œë²„ì— ì—…ë°ì´íŠ¸ ìš”ì²­]
    B --> C{ì„œë²„ ì‘ë‹µ ì„±ê³µ?}
    C -->|Yes| D[ì—…ë°ì´íŠ¸ëœ í”„ë¡œí•„ ë°ì´í„° ìˆ˜ì‹ ]
    C -->|No| E[ì—ëŸ¬ ë©”ì‹œì§€ í‘œì‹œ]
    D --> F[updateProfile í•¨ìˆ˜ í˜¸ì¶œ]
    F --> G[ë¡œì»¬ ìƒíƒœ ì—…ë°ì´íŠ¸]
    F --> H[localStorage ìºì‹œ ì—…ë°ì´íŠ¸]
    G --> I[UI ì¦‰ì‹œ ë°˜ì˜]
    H --> I
    I --> J[ë§ˆì´í˜ì´ì§€ë¡œ ì´ë™]
```

### ğŸ”§ **ê¸°ìˆ ì  ì„¸ë¶€ì‚¬í•­**

#### **ìºì‹œ ê°±ì‹  ê³¼ì •**
```javascript
// 1. ë¡œì»¬ ìƒíƒœ ì—…ë°ì´íŠ¸
setProfile(updatedProfileData);

// 2. localStorage ìºì‹œ ì—…ë°ì´íŠ¸
localStorage.setItem('supabase.auth.profile', JSON.stringify(updatedProfileData));
localStorage.setItem('supabase.auth.profileCacheTime', Date.now().toString());
```

#### **API ì‘ë‹µ ì²˜ë¦¬**
```javascript
const result = await response.json();
// result.profileì— ì—…ë°ì´íŠ¸ëœ í”„ë¡œí•„ ë°ì´í„°ê°€ í¬í•¨ë¨
if (result.profile) {
  await updateProfile(result.profile);
}
```

### ğŸ‰ **ê²°ê³¼**

- âœ… **ì¦‰ì‹œ ë°˜ì˜**: í”„ë¡œí•„ ë³€ê²½ í›„ ë°”ë¡œ í™”ë©´ì— ë°˜ì˜
- âœ… **ìºì‹œ ì¼ê´€ì„±**: ë¡œì»¬ ìºì‹œì™€ ì„œë²„ ë°ì´í„° ë™ê¸°í™”
- âœ… **ì‚¬ìš©ì ê²½í—˜**: í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨ ì—†ì´ ì¦‰ì‹œ ì—…ë°ì´íŠ¸
- âœ… **ì„±ëŠ¥ í–¥ìƒ**: ë¶ˆí•„ìš”í•œ ì„œë²„ ìš”ì²­ ê°ì†Œ
